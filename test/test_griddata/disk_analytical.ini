[grid]
dimension = 2
path = test_cell.msh
refinement_level = 2

[compartments]
outer.expression = (gmsh_id == 1)
inner.expression = (gmsh_id == 2)

[parser_context]
phi.type = constant
phi.value = 1

[model.assembly]
type = concurrent
partition.patches = 64

[model.scalar_field.u_in]
compartment = inner
cross_diffusion.u_in.expression = 1
outflow.outer.expression = phi*(u_in - u_out)
outflow.outer.jacobian.u_in.expression = phi
outflow.outer.jacobian.u_out.expression = -phi

[model.scalar_field.u_out]
compartment = outer
cross_diffusion.u_out.expression = 1 + position_x^2
storage.expression = 0
constrain.boundary.expression = position_x
outflow.inner.expression = phi*(u_out - u_in)
outflow.inner.jacobian.u_out.expression = phi
outflow.inner.jacobian.u_in.expression = -phi

[model]
is_linear = true
parser_type = ExprTk

[model.writer.vtk]
path = disk_analytical

[model.time_step_operator]
time_step_max = 1
time_end = 4
