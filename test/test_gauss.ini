
[grid]
dimension = 2
extensions = 2 2
origin = -1 -1
refinement_level = 5

[compartments.domain]
type = expression
expression = 1

[parser_context.diffusion]
type = constant
value = 0.005

[parser_context.gauss]
type = function
expression = x, y, z, t: exp(-(x^2+y^2+z^2)/(4*t*diffusion)) / (4*3.14159265359*t*diffusion)

[model]
is_linear = true

[model.scalar_field.u]
compartment = domain

[model.scalar_field.u.cross_diffusion.u]
expression = diffusion

[model.scalar_field.u.initial]
expression = gauss(position_x, position_y, position_z, time)

[model.scalar_field.u.storage]
expression = 1

[model.time_step_operator]
time_begin = 1
time_end = 4


[model.reduce]
# int(1)
domain_size.evaluation.expression = 1

# int(u)
u_mass.evaluation.expression = u

# int(gauss(...))
u_mass_analytic.evaluation.expression = gauss(position_x, position_y, position_z, time)

# max(u)
u_max.evaluation.expression = u
u_max.reduction.expression = init, val, weight: max(init, val)

# ||u - u_h||
u_error.evaluation.expression = (u - gauss(position_x, position_y, position_z, time))^2
u_error.transformation.expression = arg: sqrt(arg)
u_error.error.expression = arg: arg > 0.15

[model.writer.vtk]
path = gauss
